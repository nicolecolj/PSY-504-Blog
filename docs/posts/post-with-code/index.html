<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nicole Johnson">
<meta name="dcterms.date" content="2024-05-08">

<title>Nicole Johnson - Permutation Tests with Multinomial Logistic Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Nicole Johnson</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Permutation Tests with Multinomial Logistic Regression</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">code</div>
                <div class="quarto-category">statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Nicole Johnson </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 8, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>This tutorial will guide you through the implementation of permutation testing for assessing the significance of coefficients in a multinomial logistic regression model using R. The function <code>calc_pval</code> is provided for this purpose, which we will dissect step by step to understand its components and usage.</p>
<section id="overview-of-permutation-testing" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-permutation-testing">Overview of Permutation Testing</h2>
<p>Permutation testing is a versatile non-parametric statistical tool that allows researchers to test hypotheses about relationships within their data without relying on traditional assumptions about the underlying distribution of the data. This method is particularly useful in fields where the normality assumption does not hold or is difficult to verify.</p>
<section id="principle-of-permutation-testing" class="level3">
<h3 class="anchored" data-anchor-id="principle-of-permutation-testing">Principle of Permutation Testing</h3>
<p>At its core, permutation testing involves randomly rearranging (permuting) the labels or values of a dataset and recalculating the statistic of interest, such as a correlation coefficient or regression coefficient, across many such rearranged samples. The idea is to generate a distribution of the statistic under the null hypothesis, which states that there is no association between the variables being tested.</p>
</section>
<section id="steps-in-permutation-testing" class="level3">
<h3 class="anchored" data-anchor-id="steps-in-permutation-testing">Steps in Permutation Testing</h3>
<ol type="1">
<li><p><strong>Define the Test Statistic</strong>: First, identify the statistic that you will use to measure the association between variables. In the case of regression analysis, this could be the coefficients of the regression model.</p></li>
<li><p><strong>Calculate the Observed Statistic</strong>: Compute the test statistic with the original, unpermuted data. This gives you the observed value that you will compare against the results of the permuted datasets.</p></li>
<li><p><strong>Permute and Recalculate</strong>: Shuffle or permute the outcome variable or the labels of the data while keeping the structure of the data otherwise the same. Then, recalculate the test statistic for this permuted data. This process is repeated a large number of times (commonly 1,000 or more) to build up a distribution of the statistic under the null hypothesis.</p></li>
<li><p><strong>Determine Significance</strong>: Compare your observed test statistic to the distribution obtained from the permuted data. The p-value is calculated as the proportion of permuted statistics that are as extreme as or more extreme than the observed statistic. A small p-value (typically less than 0.05) suggests that the observed association is unlikely to have occurred by chance under the null hypothesis.</p></li>
</ol>
</section>
</section>
<section id="advantages-of-permutation-testing-for-multinomial-regressions" class="level2">
<h2 class="anchored" data-anchor-id="advantages-of-permutation-testing-for-multinomial-regressions">Advantages of Permutation Testing for Multinomial Regressions</h2>
<section id="but-first-what-is-multinomial-regression" class="level3">
<h3 class="anchored" data-anchor-id="but-first-what-is-multinomial-regression">But first, what is multinomial regression?</h3>
<p>In binary logistic regression, the outcome is typically modeled with a logistic function predicting the probability of one of the two categories, given a set of independent variables. Multinomial logistic regression generalizes this approach to multiple categories by using a series of logistic equations to compare each category to a reference category. The probabilities derived from these equations are relative to the reference category, which is usually chosen automatically by the software or can be manually specified.</p>
<section id="model-formulation" class="level4">
<h4 class="anchored" data-anchor-id="model-formulation">Model Formulation</h4>
<p>The model estimates the probabilities of being in each category of the dependent variable as a function of the independent variables. It does this through what are known as the log-odds or logit transformations, where each category (except the reference category) will have its own set of regression coefficients.</p>
<p>Mathematically, if you have a response variable (Y) with (K) possible outcomes, the probability of (Y) equaling a particular category (k) can be modeled as:</p>
<p>[ P(Y = k X) = ]</p>
<p>where (X_1, X_2, , X_p) are the predictor variables, and (,* , , _{kp}) are the coefficients for category (k).</p>
</section>
<section id="estimation" class="level4">
<h4 class="anchored" data-anchor-id="estimation">Estimation</h4>
<p>The coefficients (_{kj}) are typically estimated using maximum likelihood estimation (MLE). This method seeks to find the set of coefficients that maximize the likelihood of observing the sample given the model.</p>
</section>
<section id="interpretation" class="level4">
<h4 class="anchored" data-anchor-id="interpretation">Interpretation</h4>
<p>Interpreting the coefficients in multinomial logistic regression is similar to binary logistic regression, but instead of comparing the log-odds of the outcome to a “no event” condition, each coefficient represents the log-odds of being in the target category relative to the reference category, given a one-unit change in the predictor.</p>
</section>
</section>
<section id="applying-permutation-testing" class="level3">
<h3 class="anchored" data-anchor-id="applying-permutation-testing">Applying Permutation Testing</h3>
<p>Permutation testing is particularly suited for calculating p-values in the context of multinomial logistic regression for several reasons. This method provides robust and reliable significance testing that can be superior to traditional methods, especially when standard assumptions are violated or when the data structure is complex.</p>
<ol type="1">
<li><strong>Non-Parametric Approach:</strong> Multinomial logistic regression models, which predict categorical outcomes with more than two categories, often struggle with issues like non-normality of residuals and complex, nonlinear relationships between variables. Permutation testing is a non-parametric technique, meaning it does not rely on assumptions about the distribution of the variables or the form of the model. This characteristic makes it highly suitable for the categorical nature of the data in multinomial logistic regression, where such assumptions cannot be validated easily.</li>
<li><strong>Empirical P-values:</strong> Permutation testing generates empirical p-values based on the data itself, rather than relying on theoretical distributions. This is done by repeatedly shuffling the outcome variable and recalculating the model coefficients for each shuffled dataset. By comparing the observed coefficients to those from these permuted datasets, we can directly observe how extreme the actual coefficients are within the context of a null hypothesis where no predictors have a real effect on the outcomes. This direct approach is particularly useful in complex models where theoretical distributions may not adequately reflect the reality of the data.</li>
<li><strong>Handling Complex Model Structures:</strong> In multinomial logistic regression, dealing with multiple outcomes and potentially a large set of predictors can introduce complexity in interpreting interaction effects and the overall significance of predictors. Permutation testing simplifies this by treating the model as a whole during the permutation process, maintaining the structure of the data but breaking any real association between the predictors and the outcomes by shuffling. This method allows for an intuitive assessment of whether observed relationships in the data are likely to be due to chance.</li>
<li><strong>Robustness Against Overfitting and Model Assumptions:</strong> Multinomial logistic models can easily overfit, especially with a large number of predictors or complex interactions. Standard tests might falsely indicate predictors as significant due to overfitting or other violations of model assumptions (like independence of observations, homoscedasticity, etc.). Permutation testing does not assume these conditions and inherently provides a check against overfitting by evaluating how the model performance (through its coefficients) holds up under randomized conditions.</li>
<li><strong>Flexibility and Adaptability:</strong> Permutation testing is adaptable to various model specifications and data structures without the need for adjusting the fundamental approach. Whether dealing with highly imbalanced classes, different sample sizes, or unusual data distributions, permutation testing remains applicable and reliable, making it a versatile tool in statistical analysis.</li>
<li><strong>Validation of Statistical Significance:</strong> Using permutation testing to calculate p-values provides a straightforward and conceptually simple method to validate the statistical significance of coefficients in a multinomial logistic regression. This method can be particularly persuasive when presenting findings to a broader audience, including those who may not be familiar with the intricacies of more complex statistical methodologies.</li>
</ol>
</section>
</section>
<section id="tutorial-on-permutation-testing-for-p-values-in-multinomial-regression" class="level2">
<h2 class="anchored" data-anchor-id="tutorial-on-permutation-testing-for-p-values-in-multinomial-regression">Tutorial on Permutation Testing for P-Values in Multinomial Regression</h2>
<section id="function-description-calc_pval" class="level3">
<h3 class="anchored" data-anchor-id="function-description-calc_pval">Function Description: <code>calc_pval</code></h3>
<p>The function <code>calc_pval</code> performs a permutation test on a multinomial logistic regression model fitted with specified predictors and an outcome. The function requires several inputs: - <code>df</code>: A dataframe containing the data. - <code>outcome</code>: The name of the outcome variable in the dataframe. - <code>predictors</code>: A vector of predictor variables. - <code>nreps</code>: The number of permutations to perform.</p>
</section>
<section id="function-breakdown" class="level3">
<h3 class="anchored" data-anchor-id="function-breakdown">Function Breakdown</h3>
<ol type="1">
<li><p><strong>Creating the Model Formula</strong>:</p>
<ul>
<li>Constructs a formula for the multinomial logistic regression model using the outcome and predictors.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">formula</span>(<span class="fu">paste</span>(outcome, <span class="fu">paste</span>(predictors, <span class="at">collapse =</span> <span class="st">" + "</span>), <span class="at">sep =</span> <span class="st">" ~ "</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p><strong>Fitting the Model</strong>:</p>
<ul>
<li>Fits a multinomial logistic regression model using the <code>multinom</code> function from the <code>nnet</code> package. This model is our “observed” model.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula=</span>f, <span class="at">data=</span>df, <span class="at">family=</span><span class="st">"binomial"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p><strong>Permutation Testing</strong>:</p>
<ul>
<li>Initializes a loop to perform <code>nreps</code> permutations of the outcome variable.</li>
<li>For each permutation, it shuffles the outcome variable, fits a new model, and stores the coefficients.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (i <span class="sc">&lt;</span> nreps){</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  loop_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  loop_df[, outcome] <span class="ot">&lt;-</span> <span class="fu">sample</span>(loop_df[, outcome])</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  loop_model <span class="ot">&lt;-</span> <span class="fu">multinom</span>(<span class="at">formula=</span>f, <span class="at">data=</span>loop_df, <span class="at">family=</span><span class="st">"binomial"</span>, <span class="at">trace=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  coefs_null[, , i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">summary</span>(loop_model)<span class="sc">$</span>coefficients</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p><strong>Calculating P-Values</strong>:</p>
<ul>
<li>Compares the observed coefficients to the distribution of coefficients from the permuted data.</li>
<li>Calculates two-tailed p-values for each coefficient by finding how often the permuted coefficients are as extreme as the observed coefficients.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (lev <span class="cf">in</span> model<span class="sc">$</span>lev[<span class="sc">-</span><span class="dv">1</span>]){ <span class="co"># excluding the reference category</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  null_class <span class="ot">&lt;-</span> coefs_null[lev, , ]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (coefname <span class="cf">in</span> model<span class="sc">$</span>coefnames){</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    coef_measured <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[lev, coefname]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    coef_left <span class="ot">&lt;-</span> <span class="fu">min</span>(coef_measured, <span class="sc">-</span>coef_measured)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    coef_right <span class="ot">&lt;-</span> <span class="fu">max</span>(coef_measured, <span class="sc">-</span>coef_measured)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    coef_pleft <span class="ot">&lt;-</span> <span class="fu">sum</span>(null_class[coefname, ]<span class="sc">&lt;=</span>coef_left) <span class="sc">/</span> nreps</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    coef_pright <span class="ot">&lt;-</span> <span class="fu">sum</span>(null_class[coefname, ]<span class="sc">&gt;=</span>coef_right) <span class="sc">/</span> nreps</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    row_pvals <span class="ot">&lt;-</span> <span class="fu">c</span>(row_pvals, coef_pleft <span class="sc">+</span> coef_pright)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  pvals[n,] <span class="ot">&lt;-</span> row_pvals</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ol>
</section>
<section id="usage" class="level3">
<h3 class="anchored" data-anchor-id="usage">Usage</h3>
<p>To use <code>calc_pval</code>, you need a dataframe <code>df</code> that includes at least one categorical outcome variable and one or more predictor variables. Specify the outcome variable, a list of predictor variable names, and the number of permutations you want to perform. Here’s an example call:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>result_pvals <span class="ot">&lt;-</span> <span class="fu">calc_pval</span>(<span class="at">df =</span> your_data, <span class="at">outcome =</span> <span class="st">"YourOutcomeVariable"</span>, <span class="at">predictors =</span> <span class="fu">c</span>(<span class="st">"Predictor1"</span>, <span class="st">"Predictor2"</span>), <span class="at">nreps =</span> <span class="dv">1000</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result_pvals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-dataset-college-major-choice" class="level3">
<h3 class="anchored" data-anchor-id="example-dataset-college-major-choice">Example Dataset: College Major Choice</h3>
<p>Suppose we have a dataset from a survey of college students. The dataset includes the following variables:</p>
<ul>
<li><strong>Major</strong>: The student’s chosen major (Business, Engineering, Humanities - categorical, with Humanities as the reference category).</li>
<li><strong>Math_Score</strong>: Score on a mathematics aptitude test (continuous).</li>
<li><strong>Verbal_Score</strong>: Score on a verbal aptitude test (continuous).</li>
<li><strong>Gender</strong>: Male or Female (binary, categorical).</li>
</ul>
<p>We want to model the probability of a student choosing Business or Engineering over Humanities, based on their math and verbal scores and gender.</p>
</section>
<section id="building-the-model" class="level3">
<h3 class="anchored" data-anchor-id="building-the-model">Building the Model</h3>
<p>Using R, we can specify our multinomial logistic regression model like this:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)  </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">multinom</span>(Major <span class="sc">~</span> Math_Score <span class="sc">+</span> Verbal_Score <span class="sc">+</span> Gender, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="model-output-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="model-output-interpretation">Model Output Interpretation</h3>
<p>The output of the model would give us a set of coefficients for Business and Engineering, relative to Humanities. Here’s how you might interpret these coefficients:</p>
<ul>
<li><strong>Intercept for Business</strong>: The log-odds of choosing Business over Humanities when all other variables are zero.</li>
<li><strong>Math_Score for Business</strong>: The change in log-odds of choosing Business over Humanities for a one-unit increase in Math_Score, holding other variables constant.</li>
<li><strong>Verbal_Score for Business</strong>: Similar to Math_Score, but for Verbal_Score.</li>
<li><strong>Gender for Business</strong>: The change in log-odds of choosing Business over Humanities if the student is male (assuming ‘Male’ is coded as 1).</li>
</ul>
</section>
<section id="example-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="example-interpretation">Example Interpretation:</h3>
<p>Let’s say the coefficients for Business relative to Humanities are as follows:</p>
<ul>
<li>Intercept: -1.50</li>
<li>Math_Score: 0.10</li>
<li>Verbal_Score: 0.05</li>
<li>Gender (Male): 0.25</li>
</ul>
<p>This means: - For every one-point increase in Math_Score, the log-odds of choosing Business over Humanities increases by 0.10. - Being male increases the log-odds of choosing Business over Humanities by 0.25 compared to being female.</p>
</section>
<section id="permutation-testing" class="level3">
<h3 class="anchored" data-anchor-id="permutation-testing">Permutation Testing</h3>
<p>Permutation testing in this context would involve: 1. <strong>Calculating the Observed Statistic</strong>: Compute the regression coefficients with the original data. 2. <strong>Permutation</strong>: Randomly shuffle the Major categories among the students while keeping the predictors the same. 3. <strong>Recompute Coefficients</strong>: Fit the regression model to each permuted dataset and calculate the coefficients. 4. <strong>Comparison and P-Value Calculation</strong>: Compare the observed coefficients to those obtained from the permuted datasets. The p-value for each coefficient is calculated as the proportion of times the permuted coefficients are as extreme as or more extreme than the observed coefficients.</p>
</section>
<section id="interpreting-the-permutation-test" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-the-permutation-test">Interpreting the Permutation Test:</h3>
<p>Suppose the p-value for the Gender (Male) coefficient in choosing Business over Humanities is 0.03. This suggests that the observed relationship between gender and major choice is statistically significant at a conventional alpha level of 0.05 (i.e., there is only a 3% chance that such an extreme coefficient would be observed if there was no actual association between gender and major choice).</p>
</section>
<section id="i-hope-this-was-helpful" class="level3">
<h3 class="anchored" data-anchor-id="i-hope-this-was-helpful">I hope this was helpful!</h3>
<p>Permutation testing offers a robust and adaptable approach to evaluating the significance of predictors in multinomial logistic regression models. By utilizing the <code>calc_pval</code> function as demonstrated in this tutorial, researchers can leverage this non-parametric method to conduct hypothesis testing without relying on the assumptions necessary for traditional parametric tests.</p>
<p>Whether you are dealing with small datasets, complex model structures, or non-standard data distributions, the <code>calc_pval</code> function and the principles of permutation testing described here provide a clear and intuitive framework for assessing the significance of your model coefficients!</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>